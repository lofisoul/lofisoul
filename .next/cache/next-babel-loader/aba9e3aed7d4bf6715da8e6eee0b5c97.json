{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/jasonnolfi/lofisoul/components/SCList.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport SCPlayer from './SCPlayer';\nimport FetchUser from './FetchUser';\nimport User from './User';\nimport { scAppId, scUser } from '../config';\nimport { shuffle } from '../lib/utils';\n\nvar SCList = /*#__PURE__*/function (_Component) {\n  _inherits(SCList, _Component);\n\n  var _super = _createSuper(SCList);\n\n  function SCList() {\n    var _this;\n\n    _classCallCheck(this, SCList);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      isFetching: false,\n      doneFetching: false,\n      fiveTracks: null,\n      randomTracksFromUsers: null,\n      isModalOpen: true,\n      username: '',\n      user: null,\n      fetchErrorMsg: '',\n      currentTrack: '',\n      tracks: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"soundCloudResolveUser\", function _callee(user) {\n      var userToResolve, response, errorMsg;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(SC.resolve(\"https://soundcloud.com/\".concat(user)));\n\n            case 3:\n              userToResolve = _context.sent;\n              _context.next = 6;\n              return _regeneratorRuntime.awrap(SC.get(\"/users/\".concat(userToResolve.id, \"/favorites\"), {\n                limit: 1000,\n                linked_partitioning: 1\n              }));\n\n            case 6:\n              response = _context.sent;\n\n              if (!(response.collection.length < 5)) {\n                _context.next = 10;\n                break;\n              }\n\n              _this.setState({\n                fetchErrorMsg: \"You don't have enough likes. Try favoriting some tracks on soundcloud!\"\n              });\n\n              return _context.abrupt(\"return\");\n\n            case 10:\n              _this.initTrack(userToResolve);\n\n              _this.setState({\n                user: userToResolve,\n                isModalOpen: false\n              });\n\n              _context.next = 18;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](0);\n              errorMsg = _context.t0.status === 404 ? \"Whoops! That user doesn't exist!\" : _context.t0.message;\n\n              _this.setState({\n                fetchErrorMsg: errorMsg\n              });\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 14]], Promise);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"saveToState\", function (e) {\n      _this.setState(_defineProperty({}, e.target.name, e.target.value));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSubmit\", function (e) {\n      e.preventDefault();\n\n      _this.soundCloudResolveUser(_this.state.username);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"initTrack\", function _callee3(user) {\n      var response, sortedTracks, randomPlaylist;\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              //initialize SC\n              _this.setState({\n                isFetching: true\n              });\n\n              _context3.next = 3;\n              return _regeneratorRuntime.awrap(SC.get(\"/users/\".concat(user.id, \"/favorites\"), {\n                limit: 1000,\n                linked_partitioning: 1\n              }));\n\n            case 3:\n              response = _context3.sent;\n              sortedTracks = shuffle(response.collection, 5); //run logic for getting random song based on users that liked 5 sorted tracks\n\n              _context3.next = 7;\n              return _regeneratorRuntime.awrap(Promise.all(sortedTracks.map(function _callee2(item) {\n                var newItem;\n                return _regeneratorRuntime.async(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        _context2.next = 2;\n                        return _regeneratorRuntime.awrap(_this.generateRandomPlaylist(item));\n\n                      case 2:\n                        newItem = _context2.sent;\n                        return _context2.abrupt(\"return\", newItem);\n\n                      case 4:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, null, null, null, Promise);\n              })));\n\n            case 7:\n              randomPlaylist = _context3.sent;\n\n              _this.setState({\n                isFetching: false,\n                fiveTracks: sortedTracks,\n                randomTracksFromUsers: randomPlaylist\n              });\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"generateRandomPlaylist\", function _callee4(track) {\n      var usersWhoLiked, userArr, arrayUsersFaves, randomUser, userFaves, randomTrack, randomObj;\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(SC.get(\"/tracks/\".concat(track.id, \"/favoriters\"), {\n                limit: 1000,\n                linked_partitioning: 1\n              }));\n\n            case 2:\n              usersWhoLiked = _context4.sent;\n              userArr = usersWhoLiked.collection;\n              arrayUsersFaves = userArr.filter(function (user) {\n                return user.public_favorites_count > 0;\n              }); //sort users without playlists\n              //TODO::need to figure out a way to filter out user\n\n              randomUser = shuffle(arrayUsersFaves, 1)[0]; //get first list of random users\n\n              _context4.next = 8;\n              return _regeneratorRuntime.awrap(SC.get(\"/users/\".concat(randomUser.id, \"/favorites\"), {\n                limit: 1000,\n                linked_partitioning: 1\n              }));\n\n            case 8:\n              userFaves = _context4.sent;\n              randomTrack = shuffle(userFaves.collection, 1)[0];\n              randomObj = {\n                referral: track,\n                user: randomUser,\n                track: randomTrack\n              };\n              return _context4.abrupt(\"return\", randomObj);\n\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      SC.initialize({\n        client_id: scAppId,\n        redirect_uri: 'http://jambox.thatdudeartoo.com/callback.html'\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(SCList, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          isFetching = _this$state.isFetching,\n          fiveTracks = _this$state.fiveTracks,\n          randomTracksFromUsers = _this$state.randomTracksFromUsers,\n          isModalOpen = _this$state.isModalOpen,\n          username = _this$state.username,\n          fetchErrorMsg = _this$state.fetchErrorMsg,\n          doneFetching = _this$state.doneFetching,\n          user = _this$state.user;\n      return __jsx(React.Fragment, null, fiveTracks && __jsx(SCPlayer, {\n        currentTrack: fiveTracks[0],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 34\n        }\n      }), __jsx(FetchUser, {\n        onSubmit: this.onSubmit,\n        isModalOpen: isModalOpen,\n        username: username,\n        saveToState: this.saveToState,\n        fetchErrorMsg: fetchErrorMsg,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 17\n        }\n      }), user ? __jsx(User, {\n        user: user,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 27\n        }\n      }) : '', isFetching ? __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 32\n        }\n      }, \"Fetching...\") : __jsx(React.Fragment, null, __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 17\n        }\n      }, fiveTracks ? fiveTracks.map(function (track) {\n        return __jsx(\"div\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 32\n          }\n        }, __jsx(\"p\", {\n          key: track.id,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 37\n          }\n        }, __jsx(\"strong\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 55\n          }\n        }, track.user.username), __jsx(\"br\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 93\n          }\n        }), \": \", track.title), __jsx(\"iframe\", {\n          width: \"100%\",\n          height: \"166\",\n          scrolling: \"no\",\n          frameborder: \"no\",\n          allow: \"autoplay\",\n          src: \"https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/\".concat(track.id),\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 25\n          }\n        }));\n      }) : ''), __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 17\n        }\n      }, randomTracksFromUsers ? randomTracksFromUsers.map(function (item) {\n        return __jsx(\"div\", {\n          key: item.track.id,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 32\n          }\n        }, __jsx(\"p\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 29\n          }\n        }, __jsx(\"strong\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 32\n          }\n        }, \"User:\"), \" \", item.user.username), __jsx(\"p\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 29\n          }\n        }, \"Song: \", item.track.title), __jsx(\"p\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 29\n          }\n        }, \"Referral: \", item.referral.title), __jsx(\"iframe\", {\n          width: \"100%\",\n          height: \"166\",\n          scrolling: \"no\",\n          frameborder: \"no\",\n          allow: \"autoplay\",\n          src: \"https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/\".concat(item.track.id),\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 29\n          }\n        }));\n      }) : '')));\n    }\n  }]);\n\n  return SCList;\n}(Component);\n\nexport default SCList;","map":{"version":3,"sources":["/Users/jasonnolfi/lofisoul/components/SCList.js"],"names":["React","Component","styled","SCPlayer","FetchUser","User","scAppId","scUser","shuffle","SCList","isFetching","doneFetching","fiveTracks","randomTracksFromUsers","isModalOpen","username","user","fetchErrorMsg","currentTrack","tracks","SC","resolve","userToResolve","get","id","limit","linked_partitioning","response","collection","length","setState","initTrack","errorMsg","status","message","e","target","name","value","preventDefault","soundCloudResolveUser","state","sortedTracks","Promise","all","map","item","generateRandomPlaylist","newItem","randomPlaylist","track","usersWhoLiked","userArr","arrayUsersFaves","filter","public_favorites_count","randomUser","userFaves","randomTrack","randomObj","referral","initialize","client_id","redirect_uri","onSubmit","saveToState","title"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport SCPlayer from './SCPlayer'\nimport FetchUser from './FetchUser';\nimport User from './User';\nimport {scAppId, scUser} from '../config';\nimport {shuffle} from '../lib/utils';\n\nclass SCList extends Component {\n    state = {\n        isFetching: false,\n        doneFetching: false,\n        fiveTracks: null,\n        randomTracksFromUsers: null,\n        isModalOpen: true,\n        username: '',\n        user:null,\n        fetchErrorMsg: '',\n        currentTrack: '',\n        tracks: null,\n    }\n\n    //function to resolve soundcloud user\n    soundCloudResolveUser = async (user) => {\n        try {\n            const userToResolve = await SC.resolve(`https://soundcloud.com/${user}`);\n            const response = await SC.get(`/users/${userToResolve.id}/favorites`,{\n                limit:1000,\n                linked_partitioning:1\n            })\n\n            if(response.collection.length<5) {\n                this.setState({fetchErrorMsg: `You don't have enough likes. Try favoriting some tracks on soundcloud!`});\n                return\n            }\n            this.initTrack(userToResolve);\n            this.setState({user:userToResolve, isModalOpen:false});\n        } catch(e) {\n            const errorMsg = e.status===404 ? `Whoops! That user doesn't exist!` : e.message; \n            this.setState({fetchErrorMsg: errorMsg});  \n        }\n    }\n\n    //get SC user from form\n    saveToState = e => {\n        this.setState({[e.target.name]:e.target.value})\n    }\n\n    onSubmit = e => {\n        e.preventDefault();\n        this.soundCloudResolveUser(this.state.username);\n    }\n    \n    initTrack = async (user) => {\n        //initialize SC\n        this.setState({isFetching:true})\n        \n        const response = await SC.get(`/users/${user.id}/favorites`,{\n            limit:1000,\n            linked_partitioning:1\n        })\n\n        const sortedTracks = shuffle(response.collection,5);\n\n        //run logic for getting random song based on users that liked 5 sorted tracks\n        let randomPlaylist = await Promise.all(sortedTracks.map(async(item) => {\n            \n            let newItem = await this.generateRandomPlaylist(item);\n            return newItem\n        }))\n        \n        \n        \n        this.setState({isFetching:false, fiveTracks:sortedTracks, randomTracksFromUsers: randomPlaylist}); \n    }\n\n    generateRandomPlaylist = async (track) => {\n        const usersWhoLiked = await SC.get(`/tracks/${track.id}/favoriters`,{\n            limit: 1000,\n            linked_partitioning:1\n        })\n \n        let userArr = usersWhoLiked.collection;\n        const arrayUsersFaves = userArr.filter(user=> user.public_favorites_count>0)\n        //sort users without playlists\n        //TODO::need to figure out a way to filter out user\n        let randomUser = shuffle(arrayUsersFaves,1)[0];\n        //get first list of random users\n        const userFaves = await SC.get(`/users/${randomUser.id}/favorites`,{\n            limit: 1000,\n            linked_partitioning:1\n        });\n        const randomTrack = shuffle(userFaves.collection,1)[0];\n        const randomObj = {\n            referral: track,\n            user: randomUser,\n            track: randomTrack\n        }\n        return randomObj\n    }\n\n    componentDidMount = () => {\n        SC.initialize({\n            client_id: scAppId,\n            redirect_uri: 'http://jambox.thatdudeartoo.com/callback.html'\n        });\n\n    }\n    render() {\n        const {isFetching, fiveTracks, randomTracksFromUsers, isModalOpen, username, fetchErrorMsg,doneFetching, user} = this.state;\n        return (\n            <>\n                {(fiveTracks) && <SCPlayer currentTrack={fiveTracks[0]} />}\n                <FetchUser onSubmit={this.onSubmit} isModalOpen={isModalOpen} username={username} saveToState={this.saveToState} fetchErrorMsg={fetchErrorMsg} />\n                {(user) ? <User user={user} /> : ''}\n                {isFetching ? (<div>Fetching...</div>) : (\n                <>\n                <div>\n                    {(fiveTracks) ? fiveTracks.map(track=>{\n                        return <div><p key={track.id}><strong>{track.user.username}</strong><br/>: {track.title}</p>\n                        <iframe width=\"100%\" height=\"166\" scrolling=\"no\" frameborder=\"no\" allow=\"autoplay\" src={`https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/${track.id}`}></iframe>\n                        </div>\n                    }) : ''}\n                </div>\n                <div>\n                    {(randomTracksFromUsers) ? randomTracksFromUsers.map(item=>{\n                        return <div key={item.track.id}>\n                            <p><strong>User:</strong> {item.user.username}</p>\n                            <p>Song: {item.track.title}</p>\n                            <p>Referral: {item.referral.title}</p>\n                            <iframe width=\"100%\" height=\"166\" scrolling=\"no\" frameborder=\"no\" allow=\"autoplay\" src={`https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/${item.track.id}`}></iframe>\n                        </div>\n                    }) : ''}\n                </div>\n                </>\n                )}\n            </>\n        )\n    }\n}\n\nexport default SCList;"]},"metadata":{},"sourceType":"module"}